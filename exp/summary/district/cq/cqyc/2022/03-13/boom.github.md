# 📛 扫雷 (boom)
| 🌏 来源  | 🔗 链接 | ⏱️ 时间限制 | 💾 空间限制 | 🗄️ 难度 | 🎖️ 状态 |
|--------|--------|-------------|-------------|--------|----------|
| 保密资料 | 无      | 2.0s        | 512MB       | 暂无评定 | AC       |
* 🔖 标签: 模拟

## 📘 内容
### 🎴 背景
你需要编写一个扫雷交互器, 获取地图信息, 依次读入玩家操作并返回对应结果.   
扫雷的局面是一个 ![n \times m](https://latex.codecogs.com/svg.image?n&space;\times&space;m) 的矩形, 其中一些位置为`地雷`而另一些位置为`空地`, 扫雷局面将以字符矩阵的形式输入. 将第 i 行第 j 列的位置记作 <i, j> . 特别地, 令 k 为地雷的数量, 保证有 ![0 \le k \le n \times m](https://latex.codecogs.com/svg.image?0&space;\le&space;k&space;\le&space;n&space;\times&space;m).   
一开始玩家无法得知除了 n, m, k 之外的扫雷局面的任何信息.   
你需要维护名为`玩家地图`的字符矩阵, 初始时矩阵中所有元素为 `_` （下划线）. 

### 🧾 描述
 
玩家将进行 q 次操作, 每次将选取一个位置 <x, y> , 并用以下三种方式之一点击（若`游戏结束`, 你应该忽略游戏结束后的所有玩家操作, 即判定这些操作为`无效操作`, 反之即为`有效操作`）：
1. 左键点击：
若 <x, y> 已经`被打开`或`玩家地图`中这个位置为 `P` （ P 表示旗子）, 则不进行任何操作; 否则若 <x, y> 为地雷, 则`游戏失败`; 否则对 <x, y> 进行打开操作. 
2. 右键点击：
若 <x, y> 已经`被打开`, 则不进行任何操作; 否则
   * 若`玩家地图`中位置 <x, y> 为 `_` , 将其改为 `P` , 
   * 若`玩家地图`中位置 <x, y> 为 `P` , 将其改为 `?` , 
   * 若`玩家地图`中位置 <x, y> 为 `?` , 将其改为 `_` . 
3. 中键点击：
若 <x, y> 未`被打开`, 或`玩家地图`中这个位置周围相邻的 8 个位置的 `P` 的个数`不等于玩家地图`中该位置的数值, 则不进行任何操作; 否则对于 <x, y> 周围相邻 8 个未`被打开`且在玩家地图中不是 `P` 的位置, 如果存在至少一个位置是地雷, 则`游戏失败`; 否则对这些位置进行`打开操作`. 

`打开操作`：
对位置 <x, y> 进行的`打开操作`按照如下方式进行：
1. 将 <x, y> 标记为被打开. 
2. 在玩家地图中位置 <x, y> 改为 ![c (0 \le c \le 8)](https://latex.codecogs.com/svg.image?c&space;(0&space;\le&space;c&space;\le&space;8)) , 表示这个位置周围相邻 的 8 个位置的地雷数量. 
3. 如果 c = 0 , 则对其周围相邻的 8 个`未被打开`且在玩家地图中不是 `P` 的位置进行`打开操作`. 
4. 这个操作是递归进行的, 直到所有子操作都结束后, 本次`打开操作`才算结束. 

`游戏结束`, 游戏结束有以下三种情况：
1. `游戏失败`：即上述规则中的情况, 试图对为地雷的位置进行打开操作就会导致`游戏失败`. 
2. `游戏胜利`：若某一次操作结束后, 未被打开的位置个数恰好为 k , 则此次操作后`游戏胜利`. 
3. `退出游戏`：若玩家操作结束, 但上述两种情况均未出现, 则视作玩家`退出游戏`. 

在每一次操作后, 你需要返回结果, 具体规则如下：
* 若此次操作为`无效操作`, 返回 `INVALID` ; 否则
* 若此次操作后`游戏失败`, 返回 `LOSE` ; 否则
  * 先返回 RUNNING: , 然后在同一行返回用中括号包含的, `玩家地图`中有更改的位置以及更改后的值, 格式为 <x, y, val> ; 更改的位置按照 x 坐标为第一关键字从小到大, y 坐标为第二关键字从小到大的顺序排序, 相邻两个更改的位置用 , 隔开. 例如某一次操作后可能返回： *RUNNING: [<2, 2, 2>, <2, 3, 1>, <3, 2, 1>, <3, 3, 0>]* 或 *RUNNING: [] 或 RUNNING: [<3, 3, ?>]* . `注意其中空格的位置`. 
* 若此次操作后`游戏胜利`, 再在新的一行返回 `WIN` . 
* 若此次操作后`退出游戏`, 再在新的一行返回 `QUIT` . 

### 🖥️ 输入输出
* 输入格式:  
本题输入文件包含多组数据.   
第一行一个正整数 T 表示数据组数, 接下来每 n + q + 2 行（意义见下）表示一组数据.   
每组数据第一行两个正整数 n, m 分别表示扫雷局面的高度和宽度.   
每组数据接下来 n 行, 第 i 行一个长度为 m 的字符串, 仅包含 `_` 和 `*` 两种字符. 如果第 j 个字符为 `*` , 则表示第 i 行第 j 列为地雷, 否则为空地.   
每组数据接下来若干行, 每行三个正整数 op, x, y 表示玩家的一次操作,   
具体操作见题目描述.   
每组数据最后一行一个数 0 , 表示玩家操作结束. 令玩家操作次数为 q .   


* 输出格式:  
对于每组数据, 输出若干行, 每行表示一次操作的返回结果, 若在某一次操作后`游戏结束`, 请输出对应的结果.   
相邻的两组数据之间使用一行 `==========` （10 个 `=` 字符, 不包含引号）隔开. 


### 🏴 样例
见文件

### 📦 限制
对于所有测试点：  
![](https://latex.codecogs.com/svg.image?1&space;\le&space;T&space;\le&space;30,&space;3&space;\le&space;n,&space;m&space;\le&space;200,&space;0&space;\le&space;q&space;\le&space;10000,&space;op&space;\in&space;\{1,&space;2,&space;3\},&space;1&space;\le&space;x&space;\le&space;n,&space;1&space;\le&space;y&space;\le&space;m), 保证输入的字符串仅包含 `_` 和 `*` 两种字符.   
| 测试点编号 | n | m | k | 特殊限制 |
| --------- | - | - | - | ------- |
| 1 | =9 | =9 | =10 | 使用真实游戏生成 |
| 2 | =16 | =16 | =40 | 使用真实游戏生成 |
| 3 | =16 | =30 | =99 | 使用真实游戏生成 |
| 4 | ![\le 40](https://latex.codecogs.com/svg.image?\le&space;40) | ![\le 40](https://latex.codecogs.com/svg.image?\le&space;40) | ![\le 320](https://latex.codecogs.com/svg.image?\le&space;320) | 使用真实游戏生成 |
| 5 ~ 8 | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | ![\le 10000](https://latex.codecogs.com/svg.image?\le&space;10000) | op = 1 |
| 9 ~ 12 | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | [$\le 10000$](https://latex.codecogs.com/svg.image?\le&space;10000) | ![op \in \{1, 2\}](https://latex.codecogs.com/svg.image?op&space;\in&space;\{1,&space;2\}) |
| 13 ~ 16 | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | [$\le 10000$](https://latex.codecogs.com/svg.image?\le&space;10000) | ![op \in \{1, 3\}](https://latex.codecogs.com/svg.image?op&space;\in&space;\{1,&space;3\}) |
| 17 ~ 20 | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | ![\le 200](https://latex.codecogs.com/svg.image?\le&space;200) | [$\le 10000$](https://latex.codecogs.com/svg.image?\le&space;10000) | 无 |

### 📝 说明
以下是对样例一五组数据的解释, 每组数据从左到右依次描述了扫雷局面以及每一次`有效操作`后`玩家矩阵`：  
第一组数据：
```
_ _ * | _ _ _ | 0 1 _
_ _ _ | _ _ _ | 0 1 1
_ _ _ | _ _ _ | 0 0 0
```
第二组数据：
```
_ * _ | _ _ _ | _ _ _ | _ _ 2 | _ P 2 | _ P 2 | 1 P 2
_ _ * | _ _ _ | 1 2 _ | 1 2 _ | 1 2 _ | 1 2 P | 1 2 P
_ _ _ | _ _ _ | 0 1 _ | 0 1 _ | 0 1 _ | 0 1 _ | 0 1 1
```
第三组数据：
```
* * * | _ _ _ | * * *
_ _ _ | _ _ _ | _ 6 _
* * * | _ _ _ | * * *
```
第四组数据（`玩家矩阵`中不包含 x 字符, 最后一个矩阵仅作说明作用, 不是真实的`玩家矩阵`）：
```
_ _ _ | _ _ _ | _ _ _
_ * _ | _ _ _ | _ x _
_ _ _ | _ _ _ | _ _ _
```
第五组数据（`玩家矩阵`中不包含 x 字符, 最后一个矩阵仅作说明作用, 不是真实的`玩家矩阵`）：
```
_ _ _ | _ _ _ | _ _ _ | _ P _ | 0 P 1
_ _ * | _ _ _ | _ 1 _ | _ 1 _ | 0 1 x
_ _ _ | _ _ _ | _ _ _ | _ _ _ | 0 1 1
```

## 🪜 路径
### 📆 2022-03-13
1. NaN -> 读题
2. NaN -> 做题
3. 16:16 -> 通过所有样例, 因该是能 AC 了

## 📰 总结
### 📆 2022-03-13
* 16:17 ->  大样例要注意卡常, 不然过不去
            还有就是, 这道题特别邪门, 堤防多组数据但是忘记 memset , 死的老惨了
* 16:18 ->  就这样吧
