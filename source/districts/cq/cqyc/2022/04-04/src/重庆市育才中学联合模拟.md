# $\quad\quad\quad\ $重庆市育才中学 联合模拟



$\quad\quad \quad\quad\quad\quad\quad\quad\quad\quad\quad\quad$**所有题均需文件输入输出**



|      题目名称      |    数对     |    礼物     |    计数     |    取模     |     图案      |
| :----------------: | :---------: | :---------: | :---------: | :---------: | :-----------: |
| **输入输出文件名** | $\rm pals$  | $\rm gift$  | $\rm count$ |  $\rm mod$  | $\rm purtree$ |
|    **时间限制**    |  $\rm 1s$   |  $\rm 1s$   |  $\rm 1s$   |  $\rm 1s$   |   $\rm 2s$    |
|    **空间限制**    | $\rm 128MB$ | $\rm 256MB$ | $\rm 256MB$ | $\rm 256MB$ |  $\rm 512MB$  |
|   **测试点数目**   |    ----     |    ----     |    ----     |    ----     |     ----      |

 **某些题时限较大，知道自己过不了的数据请 return 0，加速评测进程**











































## 数对（pals）

两个十进制整数 $A,B$ ，如果 $A$ 的某一位和B的某一位相同了，那么 $(A,B)$ 就是一组合法的数对(没有顺序)，现在给定了 $N$ 个整数，问存在多少对合法的数对呢？

### 【输入格式】

第一行一个整数 $N$ 。接下来 $N$ 行，每行一个正整数。

### 【输出格式】

输出一个整数，表示合法数对个数

### 【样例】

```
3
12
1
2
```

```
2
```

### 【数据范围】

对于$30\%$的数据，$N≤1500$。

对于$100\%$的数据，$N≤1000000$，每个正整数 $≤10^{18}$。

































## 礼物（gift）

愚人节到了！可爱的【】要给孩子们送礼物。在平面直角坐标系上，有 $N$ 个点，分别代表 $N$ 个小朋友的地理位置；还有一个点，这是【】的家，【】的所有礼物都放在这里，【】必须驮着礼物从这里出发，送完礼物以后再返回这里，然后再拿出礼物出发。【】身上每多驮一个礼物，他的速度就减半。已知他不驮礼物的速度是 $V$ 。为了不耽误（你懂的），【】必须尽快完成这个任务。求完成任务的最短时间。

### 【输入格式】

第 $1$ 行 $1$ 个正整数，表示小朋友的个数。

以下 $N+1$ 行每行两个整数，除第一个表示【】的家以外，其他都表示一个小朋友的坐标。

最后一行一个整数 $V$ ，表示 【】 的速度。

### 【输出格式】

输出一个整数，表示最短时间。四舍五入。

### 【样例 1 】

```
4
0 0
-10 0
0 10
10 0
0 -10
1
```

```
120
```

### 【数据范围】

对于 $50\%$ 的数据，$N\leq10$;

对于 $100\%$ 的数据，$N\leq 17$，坐标绝对值不大于 $10^6$ ，$V<=100$。























## 计数（count）

【】是一名噗叽组选手。

【】学习了递归，他想生成一棵树，于是他写下了这样的代码：

```c++
int cnt=0;
int solve(int n){
    if(n==0){cnt++;return cnt-1;}
    int ls=solve(n-1);int rs=solve(n-1);
    adde(ls,rs);return ls;
}
```

其中 `adde(x,y)` 表示加入一条连接 $x,y$ 的边。

可以发现，如果运行 `solve(n)` 可以得到一棵有 $2^n$ 个点的树，这棵树从 $0$ 开始编号，【】在 `adde` 中加入了输出，并把输出重定向到了一个文件，接着调用 `solve(1e6)` ，然后【】的硬盘就寄掉了。

但是他决定继续思考得到的树。他想知道给出 $x,d$ 的情况下，树上有多少个点 $y$ 满足 $x,y$ 在树上的最短路长度**等于** $d$。输出对 $998244353$ 取模的结果。

然而 $x$ 可能非常大，所以【】会以以下方式给出 $x$：

对于第 $i$ 次询问，给出 $k_i$ 以及 $k_i$ 个两两不同的非负整数 $v_1,...v_{k_i}$ 表示 $x$ 的二进制中为 $1$ 的位为 $v_1,...v_{k_i}$。

**保证 $v$ 递增**。

### 【输入格式】

第一行包含两个非负整数 $n,q$。

接下来 $q$ 行，每行包含一次询问。

这部分的第 $i$ 行首先包含一个非负整数 $k_i$，接下来 $k_i$ 个非负整数 $v_1,...v_{k_i}$，最后一个正整数 $d_i$，表示询问树上与 $x$ 距离等于 $d_i$ 的点数。

### 【输出格式】

输出 $q$ 行，表示每次询问的答案对 $998244353$ 取模的结果。

### 【样例 1 】

```
4 5
1 1 1
2 0 2 2
3 0 2 3 3
0 2
4 0 1 2 3 5
```

```
2
2
4
6
4
```

![](https://cdn.luogu.com.cn/upload/image_hosting/nrawis72.png)

询问为 $(2,1),(5,2),(13,3),(0,2),(15,5)$

### 【数据范围】

对于所有数据，保证 $1\leq n\leq 10^7$，$1\leq q\leq 2\times 10^5$，$0\leq \sum k_i\leq 10^6$，$1\leq d_i\leq 2n$。

| 子任务编号 |       特殊限制        | 分值 |
| :--------: | :-------------------: | :--: |
|    $1$     |         $q=0$         | $5$  |
|    $2$     | $n\leq 10,q\leq 1000$ | $15$ |
|    $3$     |      $n\leq 18$       | $15$ |
|    $4$     |    $n,q\leq 1000$     | $20$ |
|    $5$     |     $n\leq 10^5$      | $15$ |
|    $6$     |     $n\leq 10^6$      | $20$ |
|    $7$     |      无特殊限制       | $10$ |













## 取模（mod）

【】 有一个长度为 $n$ 的序列，列中的元素都是属于 $[0,k)$ 的整数。

【】 每次可以选择一个区间 $+1$, 然后将所有元素对 $k$ 取模。

他想知道最少需要多少次操作才能将所有元素都变成 $0$。

### 【输入格式】

第一行一个整数表示 $k$。

接下来一行 $n$ 个数，第 $i$ 个数表示序列的第 $i$ 个元素。**数字之间无空格隔开**。

### 【输出格式】

一个数表示答案。

### 【样例 1 】

```
4
323
```

```
2
```

### 【样例 2 】

```
4
3121023012
```

```
7
```

### 【数据范围】

对于全部数据: $1<n\leq 10^7$，$2\leq k\leq 4$。

对于 $10\%$ 的数据，$k=2$;

对于另外 $30\%$ 的数据，$k=3$;

对于另外 $30\%$ 的数据，$n\leq 10^3$。

















## 图案（purtree）

小猫梦见自己在游戏中对战。敌营是 $n$ 个结点，以 $1$ 为根的树，其中和恰好 $1$ 个结点相邻而不为根的点叫做叶子。

敌人会为每个叶子都设定了一个整数作为密码。要想破解敌方的防线，就要获取每个叶子的密码。

现在小猫可以用 $C_i$ 金币收买其第 $i$ 个结点，这个结点就会透露出其子树内所有叶子的密码之和。

小猫当然想用最少的金币来获取各叶子的密码啦!

现在请你回答以下问题中的前 $k$ 个:

- 最少的金币数；
- 有哪些结点可能在至少一种最优解法中被收买?
- 最优解法有多少种？两种解法不同，当且仅当收买的结点的集合不同。

### 【输入格式】

第一行 $n$ 个正整数。 接下来一行 $n$ 个正整数，$c_1, c_2, . . . , c_n$ 表示收买各结点的价格。 接下来 $n − 1$ 行，每行两个不超过 $n$ 的正整数，表示树的一条边。保证这些边形成一棵树。 最后一行一个正整数 $k$ 表示要回答前 $k$ 个问题。

### 【输出格式】

第一行一个整数，表示第一个问题的答案。 如果 $k ≥ 2$, 第二行按从小到大的顺序输出若干个整数，表示结点编号。 如果 $k ≥ 3$, 第三行输出第三个问题的答案，模 $998244353$

### 【样例 1 】

```
5
500 100 300 200 100
1 2
2 3
2 4
1 5
3
```

```
400
2 4 5
1
```

### 【样例 2 】

```
3
100 100 100
1 2
1 3
3
```

```
200
1 2 3
3
```



### 【数据范围】

所有数据保证 $2 ≤ n ≤ 10^6 , c_i ≤ 10^9 , k ≤ 3$.

- 子任务 $1$（ $14$  分）： $k = 1$; 
- 子任务 $2$（ $21$  分）： $k ≤ 2$; 
- 子任务 $3$（ $14$  分）： $n ≤ 10$; 
- 子任务 $4$（ $21$  分）： $n ≤ 200$;
- 子任务 $5$（ $15$  分）： $n ≤ 3000$; 
- 子任务 $6$（ $15$  分）：无特殊限制。

